language: generic
sudo: required
node_js:
  - 10
#php:
#  - 7.3
#services:
#  - mysql
addons:
  chrome: stable
  ssh_known_hosts:
    - beta.esac.nl
    - esac.nl
before_install:
#  - npm i -g npm@version-number
  - cp .env.example .env
#  - composer self-update
#  - composer validate
#  - mysql -e 'CREATE DATABASE esac;'
install:
#  - bash install.sh
#  - composer install --no-interaction --prefer-dist --no-suggest
  - npm i -g npm@10
  - npm install npm@latest -g
  - npm install -g @lhci/cli@0.3.x
  - npm install

before_script:
#  - php artisan key:generate
#  - php artisan storage:link
#  - php artisan dusk:chrome-driver
#  - php artisan migrate
#  - php artisan db:seed
#  - npm run prod
#  - npm run prod
#  - php artisan serve &

script:
#  - global.URL = require('url').URL;
#  - vendor/bin/phpunit -c phpunit.xml --coverage-clover=coverage.xml
after_failure:
  - cat storage/logs/laravel.log
after_success:
#  - bash <(curl -s https://codecov.io/bash)
  - lhci autorun --collect.url="https://beta.esac.nl" --assert.preset=lighthouse:recommended
#  - bash deploy.sh